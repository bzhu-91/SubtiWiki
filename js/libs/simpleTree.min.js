!function(){var s="http://www.w3.org/2000/svg",w={deepExtend:function(t,e,n){for(var r in e)if(e.hasOwnProperty(r))if(e[r]&&e[r].constructor==Object)void 0===t[r]&&(t[r]={}),t[r].constructor==Object&&w.deepExtend(t[r],e[r]);else if(e[r]&&e[r]instanceof Array){t[r]=[];for(var i=0;i<e[r].length;i++)t[r].push(e[r][i])}else null==e[r]&&n?delete t[r]:null!=e[r]&&(t[r]=e[r]);return t},attrNS:function(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setAttributeNS(null,n,e[n])},attr:function(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setAttribute(n,e[n])},elNS:function(t,e){var n=document.createElementNS(s,t);return e&&w.attrNS(g,e),n},el:function(t,e){var n=document.createElement(t);return e&&w.attr(n,e),n},ucfirst:function(t){return t[0].toUpperCase()+t.slice(1)},fireEvent:function(t,e){var n;document.createEvent?(n=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(n=document.createEventObject()).eventType=e,n.eventName=e,document.createEvent?t.dispatchEvent(n):t.fireEvent("on"+n.eventType,n)},getBBox:function(t){try{return t.getBBox()}catch(t){return{height:0,width:0,x:0,y:0}}}},E=function(){var r,e={},n={},i={},o={},d={};this.x=0,this.y=0,this._setPosition=function(t,e){w.attrNS(r,{x:t,y:e})},this.hide=function(){w.attrNS(r,{visibility:"hidden"})},this.show=function(){w.attrNS(r,{visibility:"show"})},this.locate=function(t,e){null==t&&(t=this.x),null==e&&(e=this.y),this.x=t,this.y=e,this._setPosition(t,e)},this.getOptions=function(){return o},this.setDefaultOptions=function(t){e=w.deepExtend(e,t,!0),this.composeOptions(),this._applyOptions(o)},this.setPrivateOptions=function(t){i=w.deepExtend(i,t,!0),this.composeOptions(),this._applyOptions(o)},this.setGlobalOptions=function(t){n=w.deepExtend(n,t,!0),this.composeOptions(),this._applyOptions(o)},this.composeOptions=function(){o=w.deepExtend(o,e),o=w.deepExtend(o,n),o=w.deepExtend(o,i)},this._applyOptions=function(){},this.setRootElement=function(t){r=t},this.setOptions=function(t){this.setPrivateOptions(t)},this.on=function(t,e){t in d||(d[t]=[]),d[t].push(e),r.addEventListener(t,e)},this.off=function(e,t){if(t){var n=(d[e]||[]).indexOf(t);-1!=n&&(d[e]=d[e].splice(n,1),r.removeEventListener(e,t))}else(d[e]||[]).forEach(function(t){r.removeEventListener(e,t)})},this.appendTo=function(t){t.appendChild(r)},this.getBBox=function(){return w.getBBox(r)}},y={direction:"LR",width:"auto",height:"auto",margin:20,background:"transparent",node:{padding:10,textSize:12,cursor:"pointer",textColor:"blue",background:"transparent",border:"black",borderWidth:1},edge:{textSize:12,cursor:"pointer",color:"gray",width:1,textColor:"black"}};window.SimpleTree=window.SimpleTree||{};var f=function(e){var n=w.elNS("g"),o=w.elNS("rect"),d=w.elNS("text");d.textContent=e.label||"",n.appendChild(o),n.appendChild(d),w.attrNS(n,{class:"node",id:e.id||""}),w.attrNS(o,{rx:5,ry:5}),this._applyOptions=function(t){var e=w.getBBox(d),n=e.height,r=(e.width,2*t.padding+e.width),i=2*t.padding+e.height;w.attrNS(o,{width:r,height:i,fill:t.background,"stroke-width":t.borderWidth,stroke:t.border,cursor:t.cursor,x:0,y:-i/2}),w.attrNS(d,{"font-size":t.textSize,fill:t.textColor,cursor:t.cursor,x:t.padding,y:t.padding+n-i/2})},this.setRootElement(n),this._setPosition=function(t,e){w.attrNS(n,{transform:"translate("+t+","+e+")"})},w.deepExtend(this,e);var r={};for(var t in["textSize","padding","margin","cursor","textColor","background","border","borderWidth"].forEach(function(t){t in e&&(r[t]=e[t])}),this.setDefaultOptions(y.node),this.setPrivateOptions(r),e)e.hasOwnProperty(t)&&e[t]&&e[t]instanceof Function&&t.startsWith("on")&&this.on(t.substr(2),e[t]);this.setWidth=function(t){w.attrNS(d,{width:t})}},u=function(e){var n=this,r=w.elNS("g"),i=w.elNS("text"),o=w.elNS("line");r.appendChild(o),r.appendChild(i),w.attrNS(r,{class:"edge",id:e.id||""}),i.textContent=e.label||"",w.deepExtend(this,e),this.setRootElement(r),this.setWidth=function(t){var e=w.getBBox(i).width;o.setAttributeNS(null,"x2",t),i.setAttributeNS(null,"x",(t-e)/2)},this._applyOptions=function(t){var e=w.getBBox(i).width+40;e<40&&(e=60),w.attrNS(r,{cursor:t.cursor}),w.attrNS(i,{cursor:t.cursor,fill:t.textColor,"font-size":t.textSize,x:20,y:-5}),w.attrNS(o,{stroke:t.color,y1:0,y2:0,x1:0}),n.setWidth(e)},this._setPosition=function(t,e){w.attrNS(r,{transform:"translate("+t+","+e+")"})};var d={};for(var t in["cursor","color","width","textSize","textColor"].forEach(function(t){t in e&&(d[t]=e[t])}),this.setDefaultOptions(y.edge),this.setPrivateOptions(d),e)e.hasOwnProperty(t)&&e[t]&&e[t]instanceof Function&&t.startsWith("on")&&this.on(t.substr(2),e[t])},v=function(t,e){switch(t){case"node":return f.prototype=new E,new f(e);case"edge":return u.prototype=new E,new u(e);default:return console.error("Object of type "+type+" can not be handled"),null}};SimpleTree.dataSet=function(t,e){var n={},r={};t.forEach(function(t){if(!("id"in t))throw new Error("each node should have an id");n[t.id]=t}),e.forEach(function(t){t.from==t.to&&(n[t.to+"_copy"]=w.deepExtend({},n[t.to]),n[t.to+"_copy"].id=t.to+"_copy",t.to=t.to+"_copy"),t.id=t.from+"-"+t.to,t.from in r||(r[t.from]={parent:null,id:t.from,node:v("node",n[t.from]),edgeToParent:null,children:[]}),t.to in r||(r[t.to]={id:t.to,parent:null,node:v("node",n[t.to]),edgeToParent:null,children:[]}),r[t.to].parent=r[t.from],r[t.from].children.push(r[t.to]),r[t.to].edgeToParent=v("edge",t)});var i,o=[];for(var d in r)null==r[d].parent&&o.push(r[d]);var a=this;if(o.forEach(function(t){var e={},n=[t],r=!1;t:for(;n.length;){var i=n.pop();e[i.id]=2;for(var o=0;o<i.children.length;o++){var d=i.children[o];if(d.id in e){if(2==e[d.id]){r=!0;break t}}else n.push(d),e[d.id]=1}}if(r)throw new Error("data given is not a tree")}),1<o.length){var h={id:"__ROOT__",parent:null,node:new f({id:"__ROOT__"}),edgeToParent:null,children:o,depth:0};r[h.id]=h,o.forEach(function(t){t.parent=h,t.edgeToParent=new u({from:t.id,to:h.id})}),i=h}else o[0].depth=0,i=o[0];var s=0,l=function(e){e.children.forEach(function(t){t.depth=e.depth+1,t.depth>s&&(s=t.depth),t.children.length&&l(t)})};l(i),this._preorder=[];var c=function(t){a._preorder.push(t),t.children.length&&t.children.forEach(function(t){c(t)})};c(i),this._leaves=[],this._internals=[],this._preorder.forEach(function(t){0==t.children.length?a._leaves.push(t):a._internals.push(t)}),this.getNodeById=function(t){return t in r?r[t].node:null},this.getEdgeById=function(t){var e=t.split("-")[1];return e in r?r[e].edgeToParent:null},this.getChildNodes=function(t){var e=[];return t in r?(r[t].children.forEach(function(t){e.push(t.node)}),e):null},this.getParentNode=function(t){return t in r?r[t].parent.node:null},this._dimensions={width:s+1,height:this._leaves.length}},SimpleTree.diagram=function(t,l,e){SimpleTree.diagram.prototype=new E;var c=w.elNS("svg"),g=w.elNS("g");this.setRootElement(c);for((this.svg=c).appendChild(g);t.firstChild;)t.firstChild.remove();t.appendChild(c),c.id="treediagram"+Math.random(),l._preorder.forEach(function(t){t.node.appendTo(g),t.edgeToParent&&t.edgeToParent.appendTo(g)});var d=[],a=[],h=[],n=[],f=function(){l._preorder.forEach(function(t){t.gridX=t.depth,t.edgeToParent&&(t.edgeToParent.gridX=t.depth)});for(var t=l._leaves.length-1;0<=t;t--){(e=l._leaves[t]).gridY=t,e.edgeToParent&&(e.edgeToParent.gridY=t)}for(t=l._internals.length-1;0<=t;t--){var e,n=(e=l._internals[t]).children[0],r=e.children[0];e.children.forEach(function(t){t.gridY>r.gridY&&(r=t),t.gridY<n.gridY&&(n=t)}),e.firstChild=n,e.lastChild=r,e.gridY=(r.gridY+n.gridY)/2,e.edgeToParent&&(e.edgeToParent.gridY=(r.gridY+n.gridY)/2)}},u=function(t){for(var e=0;e<l._dimensions.width;e++)a[e]=0;for(e=0;e<l._leaves.length;e++)n[e]=l._leaves[e].node.getBBox().height+t;l._preorder.forEach(function(t){var e=t.depth,n=t.node.getBBox().width;t.edgeToParent&&(n+=t.edgeToParent.getBBox().width),n>a[e]&&(a[e]=n)})},v=function(t){if("LR"==t){d[0]=0;for(var e=1;e<a.length+1;e++)d[e]=d[e-1]+a[e-1]+20}else if("RL"==t){d[a.length-1]=0;for(e=a.length-2;0<=e;e--)d[e]=d[e+1]+a[e+1]+20}h[0]=0;for(e=1;e<n.length;e++)h[e]=h[e-1]+n[e-1]},x=function(t){"LR"==t?l._preorder.forEach(function(t){var e,n,r=0,i=0,o=a[t.depth];e=o-t.node.getBBox().width+d[t.gridX],n=h[Math.floor(t.gridY)]+(t.gridY-Math.floor(t.gridY))*(h[Math.ceil(t.gridY)]-h[Math.floor(t.gridY)]),t.node.locate(e,n),t.edgeToParent&&(r=d[t.edgeToParent.gridX],i=h[Math.floor(t.edgeToParent.gridY)]+(t.edgeToParent.gridY-Math.floor(t.edgeToParent.gridY))*(h[Math.ceil(t.edgeToParent.gridY)]-h[Math.floor(t.edgeToParent.gridY)]),t.edgeToParent.locate(r,i),t.edgeToParent.setWidth(o-t.node.getBBox().width))}):"RL"==t&&l._preorder.forEach(function(t){var e,n,r=0,i=0,o=a[t.depth];e=d[t.gridX],n=h[Math.floor(t.gridY)]+(t.gridY-Math.floor(t.gridY))*(h[Math.ceil(t.gridY)]-h[Math.floor(t.gridY)]),t.node.locate(e,n),t.edgeToParent&&(r=t.node.getBBox().width+d[t.edgeToParent.gridX],i=h[Math.floor(t.edgeToParent.gridY)]+(t.edgeToParent.gridY-Math.floor(t.edgeToParent.gridY))*(h[Math.ceil(t.edgeToParent.gridY)]-h[Math.floor(t.edgeToParent.gridY)]),t.edgeToParent.locate(r,i),t.edgeToParent.setWidth(o-t.node.getBBox().width))})},m=function(t){for(var e=l._internals.length-1;0<=e;e--){var n=l._internals[e];n.verticalLine||(n.verticalLine=document.createElementNS(s,"line"),g.appendChild(n.verticalLine)),n.horizontalLine||(n.horizontalLine=document.createElementNS(s,"line"),g.appendChild(n.horizontalLine));var r,i,o=0,d=0;r=n.firstChild.node.y,i=n.lastChild.node.y,"LR"==t.direction?o=(d=n.node.x+n.node.getBBox().width)+20:(t.direction="RL")&&(o=(d=n.node.x)-20),w.attrNS(n.verticalLine,{stroke:t.edge.color,"stroke-width":t.edge.width,x1:o,y1:r,x2:o,y2:i}),w.attrNS(n.horizontalLine,{stroke:t.edge.color,"stroke-width":t.edge.width,x1:o,y1:(r+i)/2,x2:d,y2:(r+i)/2})}};this._applyOptions=function(e){var t;l._preorder.forEach(function(t){t.node.setGlobalOptions(e.node),t.edgeToParent&&t.edgeToParent.setGlobalOptions(e.edge)}),t=e,f(),u(t.margin),v(t.direction),x(t.direction),m(t);var n=w.getBBox(c).width,r=w.getBBox(c).height,i=w.getBBox(c).x,o=w.getBBox(c).y;"auto"!=e.width&&(n=e.width),"auto"!=e.height&&(r=e.height),w.attrNS(c,{width:n,height:r,background:e.background});var d=Math.min(c.getBoundingClientRect().width/g.getBBox().width,c.getBoundingClientRect().height/g.getBBox().height);if(!isNaN(d)){var a=g.getAttribute("transform");if(a=a?a.split(" "):[],.001<Math.abs(i)||.001<Math.abs(o)){for(var h=!1,s=0;s<a.length;s++)-1!=a[s].indexOf("translate")&&(a[s]="translate("+(0-i)+","+(0-o)+")",h=!0);h||a.push("translate("+(0-i)+","+(0-o)+")"),w.attrNS(g,{transform:a.join(" ")})}else{for(h=!1,s=0;s<a.length;s++)-1!=a[s].indexOf("scale")&&(a[s]="scale("+d+")",h=!0);h||a.push("scale("+d+")"),w.attrNS(g,{transform:a.join(" ")})}}},this.setDefaultOptions(y),this.setGlobalOptions(e);var r=t.clientWidth,i=t.clientHeight,o=w.getBBox(g);this.zoom=function(t){if(o=w.getBBox(g),"auto"==t)t=1.2*Math.max(o.width/r,o.height/i);else if(isNaN(t))return void console.error("scale need to be a number or 'auto' in SimpleTree.diagram.zoom(scale) method");g.setAttributeNS(null,"transform","scale("+1/t+")")},this.parent=Object.getPrototypeOf(this),this.on=function(t,e){this.parent.on(t,function(t){if(t.target){for(p=t.target;p!=c&&!p.getAttribute("class");)p=p.parentNode;p!=c&&("node"==p.getAttribute("class")&&(t.currentNode=l.getNodeById(p.getAttribute("id"))),"edge"==p.getAttribute("class")&&(t.currentEdge=l.getEdgeById(p.getAttribute("id"))))}e.apply(this,[t])})}},SimpleTree.diagram.prototype=new E}();